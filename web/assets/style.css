@import "palette.css";
@import "fonts.css";

:root
  {  --item: var(--solar84);
    --input: var(--solar84);
  --outline: var(--solar60);
   --shadow: var(--solar48);
     --page: var(--solar72);
     --text: var(--solar00);
    --muted: var(--solar24);
 --consumed: var(--solar-red50);
 --produced: var(--solar-cyan50);
        --station-item: var(--solar24);
     --station-outline: var(--solar12);
        --station-text: var(--solar96);
 --station-text-shadow: var(--solar00);
       --station-muted: var(--solar84);
       --station-light: var(--solar36); }

@media (prefers-color-scheme: dark) {
:root
  {  --item: var(--ayu24);
    --input: var(--ayu24);
  --outline: var(--ayu36);
   --shadow: var(--ayu00);
     --page: var(--ayu12);
     --text: var(--ayu96);
    --muted: var(--ayu72);
 --consumed: #F07171;
 --produced: #4CBF99;
        --station-item: var(--ayu36);
     --station-outline: var(--ayu24);
        --station-text: var(--ayu96);
 --station-text-shadow: var(--ayu12);
       --station-muted: var(--ayu84);
       --station-light: var(--ayu48); } }

body
  { font: 1rem/1.1 'Exo 2', sans-serif;
    background-color: var(--page);
               color: var(--text);
              margin: 0 }

header, footer
  { font-family: sans-serif;  }

section, aside, header, footer
  { max-width: 50ch; }

.loading-screen
           { margin: 3ch auto;
          font-size: large;
  font-variant-caps: small-caps;
          max-width: 20ch }

hr { margin: 10px; border: 0; height: 0; border-bottom: 1px solid var(--outline); }

p, .entity, .process
  { margin: 10px }
.cmd
  { padding: 0 10px; box-sizing: border-box }
.surrogate
  { display: none; visibility: hidden }

a, input, button, select
  { background:  transparent;
    color:       inherit;
    font:        inherit;
    text-align:  inherit;
    text-shadow: inherit }

button, input[type=text], select
  { background-color: var(--input);
    border:           1px solid var(--outline);
    padding:    0.5ch 0.4ch;
    box-sizing: content-box; }

button          { cursor: pointer; }
button:disabled { cursor: not-allowed }

p > button { margin-left: 1ch }

input[inputmode=decimal] { text-align: right }

ul { margin: 0; padding: 0 }


/* positioning */

main > aside
  {
    position: fixed;
    left: 50ch;
    bottom: 0;
    top: 0;
  overflow: scroll; min-height: 100%; max-height: 100%  }


a.wiki-link:not(:hover),
a.identifier:not(:hover)
  { text-decoration: none }


.process .needs-recipe
    { color: var(--muted);
    display: inline-block;
     margin: 0.5ch 1ch;
  font-size: 85% }

.item > span /* vertical padding here coupled with .sprite padding */
  { padding:   0.5ch 0.4ch; }

.item > .time,
.item > .condition,
.item > .skill,
.item > .amount
  { overflow:      hidden;
    text-overflow: ellipsis;
    white-space:   nowrap }

.item > .skill
  {     color: var(--muted);
    font-size: 85% }

/* amount what    sprite */
/*   time station sprite */

.item
  { display: flex }

.item > *
  { flex: 0 0 min-content; align-self: baseline }

.item > .decoration
  { align-self: stretch;
    box-sizing: border-box;
       --inset:  8px;
       --width: 24px;
     min-width: var(--width);
     max-width: var(--width);
        margin: 0 var(--inset) }

/* stack decoration under amount text with negative margin */
.process .item > .decoration
  { margin-right: calc(0px - var(--width) - var(--inset)) }

.item > .decoration + *
  { z-index: 1 }

.item > .amount,
.item > .time
  { text-align: right; min-width: 6ch; max-width: 6ch }

.item > .station,
.item > .what
  { flex: 1 1 max-content }

.item > .taglist
  { flex-grow: 1 }

.item > .sprite
         { align-self: center;
           flex-basis: 48px;
  background-position: center;
      background-size: contain;
    background-repeat: no-repeat;
         padding-left: 0;
        padding-right: 0; }

.item.random + .random-list
  { margin-left: 1ch }


/* colors */

.item
  { background-color: var(--item);
               color: var(--text);
              border: 0 solid var(--outline);
        border-width: 0 1px 0 1px }

.item:first-of-type
  {    border-top-width: 1px }

.item:last-of-type
  { border-bottom-width: 1px }

.item.stations
  {          color: var(--station-text);
           --muted: var(--station-muted);
       text-shadow: 1px   1px var(--station-text-shadow);
  background-color: var(--station-item);
            border: 1px solid var(--station-outline);
        box-shadow: inset  1px  1px var(--station-light),
                    inset -1px -1px var(--station-light) }

.item.stations + .item.stations
  { border-top: 0 }

.item > .amount.amount-multiple::after
  { content: 'Ã—'; line-height: 0 }

/* stripe repeating */
/*.item > */ .decoration
  { --pointyness: 4px; --gap: 8px; --from-bottom: 4px;
    --tail-vee:  calc(100% - var(--from-bottom));
    --tail-wing: calc(var(--tail-vee) - var(--pointyness));
    --head-vee:  calc(var(--tail-vee) - var(--gap));
    --head-wing: calc(var(--tail-wing) - var(--gap)) }

/* calc(100% + 1px) calc(0% - 1px) helps prevent a funny horizontal gap/line
 * between decorations, still shows up a lot on edge */
/*.item > */ .decoration
  { clip-path: polygon(0   calc(0% - 1px),  100%  calc(0% - 1px),  100% var(--head-wing),   50% var(--head-vee),   0 var(--head-wing),
                       0 var(--tail-wing),   50% var(--tail-vee),  100% var(--tail-wing),  100% calc(100% + 1px),  0 calc(100% + 1px)) }

/* stripe end */
.item.produced:last-of-type .decoration
  { clip-path: polygon(0  calc(0% - 1px),  100%   calc(0% - 1px),  100% var(--head-wing),  50% var(--head-vee),  0 var(--head-wing)) }


/*.item > */ .decoration
  { background-color: var(--outline);
    /* cute or cringe ??? */
    background-image: linear-gradient(to right, #ffffff00, #ffffff20 50%, #ffffff00 50%) }
@media (prefers-color-scheme: dark)
  { .decoration
    { background-image: linear-gradient(to right, #ffffff00, #ffffff10 50%, #ffffff00 50%) } }

.item.consumed > .decoration
  { background-color: var(--consumed) }

.item.produced > .decoration
  { background-color: var(--produced) }


.identifier
  { color: var(--muted);
     font: 75% 'IBM Plex Mono', monospace }
.identifier::before { content: '{' }
.identifier::after  { content: '}' }


.cmd
  { position: sticky;
      bottom: 10px;
     z-index: 1;
    grid-gap: 1ch;
     display: flex }

.cmd[data-fixed]
  { position: fixed; width: 100%; bottom: unset }
.cmd[data-fixed] + .surrogate
  { display: block }

.cmd > * { flex: 0 0 auto }
.cmd > .search { flex: 1 1 min-content; min-width: 0 }


.cmd > *
  { --outline: var(--shadow);
       border: 1px solid var(--outline);
   box-shadow: 3px 3px var(--shadow); }


.cmd .context-search
  { display: flex;
    padding: 0;
    width: 40px }


.cmd .context-search
  { position: relative }
.cmd .context-search > *
  { position: absolute;
    left: 0; top: 0;
    width: 100%; height: 100%;
    margin: 0; appearance: none;
    display: flex }


.cmd .context-search .decoration
  { width: 24px; margin: 0 8px; pointer-events: none }


.cmd .context-search > *
  { --reach: 70%;
    --floor: calc(100% + 1px) }
.cmd .context-search:not([data-current]) > .consumed
  { clip-path: polygon(0    0%,  var(--reach) 0%,  calc(100% - var(--reach)) var(--floor),     0 var(--floor)) }
.cmd .context-search:not([data-current]) > .produced
  { clip-path: polygon(100% 0%,  var(--reach) 0%,  calc(100% - var(--reach)) var(--floor),  100% var(--floor)) }

.cmd .context-search[data-current='only-consumed'] .produced
  { display: none }
.cmd .context-search[data-current='only-produced'] .consumed
  { display: none }

.cmd .context-search > .consumed > .decoration
  { background-color: var(--consumed) }
.cmd .context-search > .produced > .decoration
  { background-color: var(--produced) }
